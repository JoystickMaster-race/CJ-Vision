import static org.apache.tools.ant.taskdefs.condition.Os.*
apply from: rootProject.file("platforms/platform.gradle")

model {
	components {
		cjVision(NativeExecutableSpec) {
			if (!isFamily(FAMILY_WINDOWS)) {
				return
			}
			
			targetPlatform wpi.platforms.desktop
			sources.cpp {
				source {
					if (project.hasProperty("debugMode")) {
						srcDirs = cj_vision_src + lib_src
					} else {
						srcDirs = cj_vision_src + lib_src + coproc_vision_src
					}
					includes = ['**/*.cpp', '**/*.cc', '**/*.c']
				}

				exportedHeaders {
					if (project.hasProperty("debugMode")) {
						srcDirs = cj_vision_headers + lib_headers
					} else {
						srcDirs = cj_vision_headers + lib_headers + coproc_vision_headers
					}
				}
			}

			binaries.all {
				if (project.hasProperty("debugMode")) {
					cppCompiler.define 'DEBUG_CJ'
				}
			}

			wpi.deps.wpilib(it)
			wpi.deps.googleTest(it)
			wpi.deps.vendor.cpp(it)
		}
	}
}